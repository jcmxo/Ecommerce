# ğŸ”„ Diagrama de Flujo Completo del Sistema

## ğŸ¥ Video de PresentaciÃ³n

[![Video de PresentaciÃ³n](https://img.youtube.com/vi/H_6zbPxbMcU/0.jpg)](https://youtu.be/H_6zbPxbMcU)

**Ver presentaciÃ³n completa:** [https://youtu.be/H_6zbPxbMcU](https://youtu.be/H_6zbPxbMcU)

---

## ğŸ“Š Flujo Principal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SISTEMA E-COMMERCE BLOCKCHAIN                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. INICIO      â”‚
â”‚                 â”‚
â”‚  - Anvil        â”‚
â”‚  - Contratos    â”‚
â”‚    desplegados  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                                 â”‚
         â–¼                                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. CLIENTE     â”‚                            â”‚  3. EMPRESA     â”‚
â”‚                 â”‚                            â”‚                 â”‚
â”‚  Wallet 1       â”‚                            â”‚  Wallet 2       â”‚
â”‚  0xf39f...2266  â”‚                            â”‚  0x1234...5678  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                             â”‚
         â”‚                                             â”‚
         â–¼                                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COMPRA EURT    â”‚                            â”‚ REGISTRA        â”‚
â”‚ (Stripe)       â”‚                            â”‚ EMPRESA         â”‚
â”‚                â”‚                            â”‚                 â”‚
â”‚ localhost:6001 â”‚                            â”‚ localhost:6003  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                             â”‚
         â”‚                                             â”‚
         â”‚                                             â–¼
         â”‚                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                  â”‚ AGREGA          â”‚
         â”‚                                  â”‚ PRODUCTOS       â”‚
         â”‚                                  â”‚                 â”‚
         â”‚                                  â”‚ - Nombre        â”‚
         â”‚                                  â”‚ - Precio        â”‚
         â”‚                                  â”‚ - Stock         â”‚
         â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                           â”‚
         â”‚                                           â”‚
         â”‚                                           â”‚
         â–¼                                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚ VISITA TIENDA   â”‚                                 â”‚
â”‚                 â”‚                                 â”‚
â”‚ localhost:6004  â”‚                                 â”‚
â”‚                 â”‚                                 â”‚
â”‚ - Ver productos â”‚                                 â”‚
â”‚ - Agregar carritoâ”‚                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
         â”‚                                          â”‚
         â”‚                                          â”‚
         â–¼                                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚ CHECKOUT        â”‚                                 â”‚
â”‚                 â”‚                                 â”‚
â”‚ - Crear factura â”‚                                 â”‚
â”‚ - Limpiar carritoâ”‚                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
         â”‚                                          â”‚
         â”‚                                          â”‚
         â–¼                                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚ PASARELA PAGOS  â”‚                                 â”‚
â”‚                 â”‚                                 â”‚
â”‚ localhost:6002  â”‚                                 â”‚
â”‚                 â”‚                                 â”‚
â”‚ Paso 1: Aprobar â”‚                                 â”‚
â”‚ Paso 2: Pagar   â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
         â”‚                                          â”‚
         â”‚                                          â”‚
         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚    â”‚
         â–¼    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   BLOCKCHAIN    â”‚
    â”‚                 â”‚
    â”‚ - Transfer EURT â”‚
    â”‚ - Actualizar    â”‚
    â”‚   stock         â”‚
    â”‚ - Marcar        â”‚
    â”‚   factura       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚
             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚                 â”‚                 â”‚
             â–¼                 â–¼                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CLIENTE     â”‚  â”‚ EMPRESA     â”‚  â”‚ HISTORIAL   â”‚
    â”‚             â”‚  â”‚             â”‚  â”‚             â”‚
    â”‚ Balance:    â”‚  â”‚ Balance:    â”‚  â”‚ Ver pedidos â”‚
    â”‚ -10 EURT    â”‚  â”‚ +10 EURT    â”‚  â”‚ Ver detallesâ”‚
    â”‚             â”‚  â”‚             â”‚  â”‚             â”‚
    â”‚ âœ…          â”‚  â”‚ âœ…          â”‚  â”‚ âœ…          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“± Flujo Detallado de Compra

```
CLIENTE                          BLOCKCHAIN                       EMPRESA
   â”‚                                â”‚                                â”‚
   â”‚ 1. Ver productos               â”‚                                â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                â”‚
   â”‚                                â”‚                                â”‚
   â”‚ 2. Agregar al carrito          â”‚                                â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                â”‚
   â”‚                                â”‚                                â”‚
   â”‚                                â”‚ 3. CartItemAdded (event)       â”‚
   â”‚                                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                                â”‚                                â”‚
   â”‚ 4. Checkout (createInvoice)    â”‚                                â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                â”‚
   â”‚                                â”‚                                â”‚
   â”‚                                â”‚ 5. InvoiceCreated (event)      â”‚
   â”‚                                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                                â”‚                                â”‚
   â”‚ 6. Redirige a pasarela         â”‚                                â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                â”‚
   â”‚                                â”‚                                â”‚
   â”‚ 7. Aprobar tokens (approve)    â”‚                                â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                â”‚
   â”‚                                â”‚                                â”‚
   â”‚ 8. Procesar pago               â”‚                                â”‚
   â”‚    (processPayment)            â”‚                                â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                â”‚
   â”‚                                â”‚                                â”‚
   â”‚                                â”‚ 9. Transferir EURT             â”‚
   â”‚                                â”‚    Cliente â†’ Empresa           â”‚
   â”‚                                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                                â”‚                                â”‚
   â”‚                                â”‚ 10. PaymentProcessed (event)   â”‚
   â”‚                                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                                â”‚                                â”‚
   â”‚ 11. Ver historial              â”‚                                â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                â”‚
   â”‚                                â”‚                                â”‚
   â”‚ 12. Factura marcada como       â”‚                                â”‚
   â”‚     "Pagada"                   â”‚                                â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                                â”‚
```

---

## ğŸ¯ Componentes del Sistema

### 1. Smart Contracts
- **EuroToken**: Token ERC20 para pagos
- **Ecommerce**: Contrato principal con toda la lÃ³gica

### 2. Aplicaciones Web
- **Compra Stablecoin** (6001): Comprar EURT con Stripe
- **Pasarela de Pagos** (6002): Procesar pagos de facturas
- **Web Admin** (6003): Gestionar empresa y productos
- **Web Customer** (6004): Tienda online para clientes

### 3. Blockchain Local
- **Anvil**: Red blockchain local en puerto 8545

---

## ğŸ” Roles y Permisos

### Cliente (Wallet 1)
- âœ… Ver productos
- âœ… Agregar al carrito
- âœ… Crear facturas
- âœ… Pagar facturas
- âœ… Ver historial

### Empresa (Wallet 2)
- âœ… Registrar empresa
- âœ… Agregar productos
- âœ… Actualizar stock
- âœ… Ver facturas recibidas
- âœ… Recibir pagos

---

## ğŸ’° Flujo de Tokens

```
INICIO: Cliente tiene 1,000,000 EURT
        Empresa tiene 0 EURT

1. Cliente compra producto de 10 EURT
   â”‚
   â”œâ”€> Cliente: 1,000,000 - 10 = 999,990 EURT âœ…
   â”‚
   â””â”€> Empresa: 0 + 10 = 10 EURT âœ…

RESULTADO: Tokens transferidos correctamente
```

---

## ğŸš¨ Errores Comunes y Soluciones

1. **Misma wallet para cliente y empresa**
   - âŒ Balance no cambia
   - âœ… Usar 2 wallets diferentes

2. **Factura ya pagada**
   - âŒ Error al intentar pagar
   - âœ… Verificar estado antes de pagar

3. **Stock insuficiente**
   - âŒ Error al crear factura
   - âœ… Actualizar stock primero

4. **Balance insuficiente**
   - âŒ Error al pagar
   - âœ… Comprar mÃ¡s EURT primero

